apiVersion: batch/v1
kind: Job
metadata:
  name: nbody
  labels:
    logging: elastic
spec:
  template: # define the pods specifications
    metadata:
      name: nbody
      labels:
        logging: elastic
      annotations:
        "co.elastic.logs/enabled": "true"
    spec:
      nodeSelector:
        gpu-model: tesla-v100
      containers:
      - name: binpack-1
        image: yhseanhsu/gpu-nbody
        command: ["./5_Simulations/nbody/nbody"]
        args: ["-benchmark", "-numbodies=70016"]
        resources:
          requests:
             cpu: "1000m"
             memory: "4Gi"
          limits:
             cpu: "1000m"
             memory: "4Gi"
             nvidia.com/gpu: "1"
      restartPolicy: Never
